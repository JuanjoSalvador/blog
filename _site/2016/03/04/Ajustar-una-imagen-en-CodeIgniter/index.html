<!DOCTYPE html>
<html lang="es-es">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Ajustar una imagen en CodeIgniter &middot; Juanjo Salvador
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/blog/public/css/poole.css">
  <link rel="stylesheet" href="/blog/public/css/syntax.css">
  <link rel="stylesheet" href="/blog/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">


  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/blog/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/blog/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/blog/">
          Juanjo Salvador
        </a>
      </h1>
      <p class="lead">Desarrollo. Debian. Software Libre.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/blog/">Inicio</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/sobre-mi/">Sobre mi</a>
          
        
      
        
          
        
      
        
      
        
          
            <a class="sidebar-nav-item" href="/curriculum/">Curriculum</a>
          
        
      
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/portfolio/">Portfolio</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="/blog/atom.xml">RSS</a>
    </nav>

    <p>&copy; 2016. Todos los derechos reservados.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Ajustar una imagen en CodeIgniter</h1>
  <span class="post-date">04 Mar 2016</span>
  <p>Para una práctica de CodeIgniter, que consistía en crear una aplicación ficticia para administrar una base de datos, necesité añadir imágenes de perfil para los usuarios de esta. Las imágenes de perfil tenían que visualizarse en una sección cuadrada de 80x80px, un poco pequeña, y que podía deformar las imágenes si no eran del tamaño adecuado al redimensionarlas en el cliente. Además de que, si estas pesan demasiado, estaríamos ante una carga excedente para la web.</p>

<h3 id="la-solucin">La solución</h3>
<p>Ajustar las imágenes a un cuadrado de 80x80 píxeles desde el servidor. Para ello, primero necesitamos recortar una sección cuadrada del centro de la imagen, y del mayor tamaño posible, para posteriormente, ajustar esa nueva imagen cuadrada al tamaño deseado.</p>

<p>En mi caso, usando como medida estándar la medida más pequeña de la imagen. Es decir, si tengo una foto de 400x150px, el recorte se hará de una sección central de 150x150.</p>

<h3 id="el-cdigo">El código</h3>

<p>Para trabajar con estas funciones de CodeIgniter, primero tenemos que añadir la librería <code class="highlighter-rouge">image_lib</code>, ya sea desde <code class="highlighter-rouge">config/autoload.php</code>, o desde la función <code class="highlighter-rouge">__construct()</code> de la clase con</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$this-&gt;load-&gt;library('image_lib');
</code></pre>
</div>

<p>Con la función <code class="highlighter-rouge">crop()</code> recortamos una sección cuadrada del centro de la imagen. Esto varía según las dimensiones de la imagen.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public function crop($img, $img_w, $img_h) {
		$config['image_library']  = 'gd2';
		$config['source_image']   = $img;
		$config['maintain_ratio'] = FALSE;

		if ($img_w &gt; $img_h) {
			$config['width']      = $img_h;
			$config['height']     = $img_h;
			$config['x_axis']     = $img_w / 4;
		}

		if ($img_h &gt; $img_w) {
			$config['width']      = $img_w;
			$config['height']     = $img_w;
			$config['y_axis']     = $img_h / 4;
		}

		if ($img_w == $img_h) {
			$config['width']      = $img_w;
			$config['height']     = $img_h;
		}

		$this-&gt;image_lib-&gt;initialize($config);

		if (!$this-&gt;image_lib-&gt;crop()) {
			echo $this-&gt;image_lib-&gt;display_errors();
		} else {
			$this-&gt;image_lib-&gt;clear();
		}
	}
</code></pre>
</div>

<p>Y con la función <code class="highlighter-rouge">resize()</code>, redimensionamos esa nueva imagen que hemos creado (y sobreescrito en nuestro directorio) al tamaño deseado, en mi caso, 80x80px.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>	public function resize($img) {
		$new_size['image_library']  = 'gd2';
		$new_size['source_image']   = $img;
		$new_size['maintain_ratio'] = TRUE;
		$new_size['width']          = 80;
		$new_size['height']         = 80;

		$this-&gt;image_lib-&gt;initialize($new_size);
		if (!$this-&gt;image_lib-&gt;resize()) {
			echo $this-&gt;image_lib-&gt;display_errors();
		}
	}
</code></pre>
</div>

<h3 id="conclusion">Conclusion</h3>
<p>A partir de una imagen de 498x670px, en formato JPG y de 315 kB de peso, conseguí crear una imagen de 80x80px, JPG y de ¡tan solo 12 kB! Con esto conseguí reducir la carga del cliente, acelerar así el tiempo de rederizado de mi web, y aprender a manejar mejor la librería de procesado de imágenes que incorpora CodeIgniter.</p>

</div>

<p align="center">
    <strong>¿Tienes alguna mejora para este artículo?</strong><br>
    <a href="https://github.com/JuanjoSalvador/juanjosalvador.github.io">
        <u>¡Mándame una pull request!</u>
    </a>
</p>

<div id="share-this">
  <h4>Comparte este artículo</h4>
  <a href="https://twitter.com/intent/tweet?text=Ajustar una imagen en CodeIgniter&url=http://localhost:4000/2016/03/04/Ajustar-una-imagen-en-CodeIgniter/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a>
<a href="https://facebook.com/sharer.php?u=http://localhost:4000/2016/03/04/Ajustar-una-imagen-en-CodeIgniter/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a>
<a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/2016/03/04/Ajustar-una-imagen-en-CodeIgniter/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a>
<a href="https://plus.google.com/share?url=http://localhost:4000/2016/03/04/Ajustar-una-imagen-en-CodeIgniter/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a>

</div>

<div class="related">
  <h2>Artículos relacionados</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2016/11/20/Desarrollo-de-apps-con-JavaScript/">
            Desarrollo de aplicaciones móviles con JavaScript
            <small>20 Nov 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2016/11/11/Como-instalar-Jekyll-en-Windows/">
            Como instalar Jekyll en Windows
            <small>11 Nov 2016</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2016/10/06/5-herramientas-que-todo-Web-Developer-debe-conocer/">
            5 herramientas que todo Web Developer debería conocer
            <small>06 Oct 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
	<div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */
    /*
    var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        
        s.src = '//juanjosalvador.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>

    </div>

  </body>
</html>
